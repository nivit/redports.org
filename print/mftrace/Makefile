# Created by: ijliao
# $FreeBSD: head/print/mftrace/Makefile 356273 2014-06-03 01:15:13Z amdmi3 $

PORTNAME=	mftrace
PORTVERSION=	1.2.18
PORTREVISION=	1
CATEGORIES=	print
MASTER_SITES=	http://lilypond.org/download/sources/mftrace/ \
		LOCAL/nivit/${PORTNAME}/

MAINTAINER=	nivit@FreeBSD.org
COMMENT=	Scalable PostScript (Type1) Fonts for MetaFont

RUN_DEPENDS=	t1asm:${PORTSDIR}/print/t1utils \
		fontforge:${PORTSDIR}/print/fontforge

.if defined(WITH_AUTOTRACE)
BUILD_DEPENDS+=	autotrace:${PORTSDIR}/graphics/autotrace
RUN_DEPENDS+=	autotrace:${PORTSDIR}/graphics/autotrace
.else
BUILD_DEPENDS+=	potrace:${PORTSDIR}/graphics/potrace
RUN_DEPENDS+=	potrace:${PORTSDIR}/graphics/potrace
.endif

# Python3 ready
USE_PYTHON=	yes
USE_TEX=	base texmf
GNU_CONFIGURE=	yes
USES=		gmake
MAKEFILE=	GNUmakefile


PLIST_FILES=	\
		bin/gf2pbm \
		bin/mftrace \
		%%PYTHON_SITELIBDIR%%/afm.py \
		%%PYTHON_SITELIBDIR%%/tfm.py
.if !defined(NO_INSTALL_MANPAGES)
PLIST_FILES+=	man/man1/mftrace.1.gz
.endif

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/gf2pbm ${STAGEDIR}${PREFIX}/bin
	${INSTALL_SCRIPT} ${WRKSRC}/mftrace ${STAGEDIR}${PREFIX}/bin
.if !defined(NO_INSTALL_MANPAGES)
	${INSTALL_MAN} ${WRKSRC}/mftrace.1 ${STAGEDIR}${MANPREFIX}/man/man1
.endif
	@${MKDIR} ${STAGEDIR}${PYTHON_SITELIBDIR}
	${INSTALL_SCRIPT} ${WRKSRC}/tfm.py ${STAGEDIR}${PYTHON_SITELIBDIR}
	${INSTALL_SCRIPT} ${WRKSRC}/afm.py ${STAGEDIR}${PYTHON_SITELIBDIR}

.include <bsd.port.mk>
